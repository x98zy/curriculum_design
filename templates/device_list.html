<!DOCTYPE html>
<html lang="en" class="no-js">
{% extends 'index1.html' %}
<head>
	<meta charset="utf-8" />
	<title>{% block title %}设备列表{% endblock %}</title>
    {% block css %}
        <link href="https://first-1257059002.cos.ap-nanjing.myqcloud.com/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
        <link href="https://first-1257059002.cos.ap-nanjing.myqcloud.com/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
        <link href="https://first-1257059002.cos.ap-nanjing.myqcloud.com/css/uniform.default.css" rel="stylesheet" type="text/css"/>
        <link rel="stylesheet" type="text/css" href="https://first-1257059002.cos.ap-nanjing.myqcloud.com/css/select2_metro.css" />
	    <link rel="stylesheet" href="https://first-1257059002.cos.ap-nanjing.myqcloud.com/css/DT_bootstrap.css" />
        <link href="https://first-1257059002.cos.ap-nanjing.myqcloud.com/css/style-metronic.css" rel="stylesheet" type="text/css"/>
        <link href="https://first-1257059002.cos.ap-nanjing.myqcloud.com/css/style1.css" rel="stylesheet" type="text/css"/>
        <link href="https://first-1257059002.cos.ap-nanjing.myqcloud.com/css/style-responsive.css" rel="stylesheet" type="text/css"/>
        <link href="https://first-1257059002.cos.ap-nanjing.myqcloud.com/css/plugins.css" rel="stylesheet" type="text/css"/>
        <link href="https://first-1257059002.cos.ap-nanjing.myqcloud.com/css/default.css" rel="stylesheet" type="text/css" id="style_color"/>
        <link href="https://first-1257059002.cos.ap-nanjing.myqcloud.com/css/custom.css" rel="stylesheet" type="text/css"/>
        <link href="https://first-1257059002.cos.ap-nanjing.myqcloud.com/css/modalBox.css" rel="stylesheet" type="text/css"/>
        <style>
             * {
                 padding: 0;
                 margin: 0;
             }
             .slider {
                 background: none;
                 min-height:120px;
                 background-color: black;
                 margin: 0 5px;
             }
        </style>
    {% endblock %}
    {% block js %}
        <script src="https://first-1257059002.cos.ap-nanjing.myqcloud.com/js/respond.min.js"></script>
	    <script src="https://first-1257059002.cos.ap-nanjing.myqcloud.com/js/excanvas.min.js"></script>
        <script src="https://first-1257059002.cos.ap-nanjing.myqcloud.com/js/jquery-1.10.2.min.js" type="text/javascript"></script>
        <script src="https://first-1257059002.cos.ap-nanjing.myqcloud.com/js/jquery-migrate-1.2.1.min.js" type="text/javascript"></script>
        <script src="https://first-1257059002.cos.ap-nanjing.myqcloud.com/js/bootstrap.min.js" type="text/javascript"></script>
        <script src="https://first-1257059002.cos.ap-nanjing.myqcloud.com//js/twitter-bootstrap-hover-dropdown.min.js" type="text/javascript" ></script>
        <script src="https://first-1257059002.cos.ap-nanjing.myqcloud.com/js/jquery.slimscroll.min.js" type="text/javascript"></script>
        <script src="https://first-1257059002.cos.ap-nanjing.myqcloud.com/js/jquery.blockui.min.js" type="text/javascript"></script>
        <script src="https://first-1257059002.cos.ap-nanjing.myqcloud.com/js/jquery.cookie.min.js" type="text/javascript"></script>
        <script src="https://first-1257059002.cos.ap-nanjing.myqcloud.com/js/jquery.uniform.min.js" type="text/javascript" ></script>
        <script type="text/javascript" src="https://first-1257059002.cos.ap-nanjing.myqcloud.com/js/jquery.dataTables.js"></script>
        <script type="text/javascript" src="https://first-1257059002.cos.ap-nanjing.myqcloud.com/js/DT_bootstrap.js"></script>
        <script src="https://first-1257059002.cos.ap-nanjing.myqcloud.com/js/app.js"></script>
        <script src="https://first-1257059002.cos.ap-nanjing.myqcloud.com/js/table-editable.js"></script>
        <script type="text/javascript" src="https://first-1257059002.cos.ap-nanjing.myqcloud.com/js/select2.min.js"></script>
        <script type="text/javascript" src="https://first-1257059002.cos.ap-nanjing.myqcloud.com/js/Echarts.js"></script>
        <script>
            jQuery(document).ready(function() {
               App.init();
               TableEditable.init();
            });
        </script>
        <script type="text/javascript" src="https://first-1257059002.cos.ap-nanjing.myqcloud.com/layer/layer.js"></script>
    {% endblock %}
</head>
{% block background %}{% endblock %}
{% block content %}
    <div class="page-container">
        <div class="page-content" style="margin-left: 0">
			<!-- BEGIN SAMPLE PORTLET CONFIGURATION MODAL FORM-->
			<div class="modal fade" id="portlet-config" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
							<h4 class="modal-title">Modal title</h4>
						</div>
						<div class="modal-body">
							Widget settings form goes here
						</div>
						<div class="modal-footer">
							<button type="button" class="btn blue">Save changes</button>
							<button type="button" class="btn default" data-dismiss="modal">Close</button>
						</div>
					</div>
					<!-- /.modal-content -->
				</div>
				<!-- /.modal-dialog -->
			</div>
			<!-- /.modal -->
			<!-- END SAMPLE PORTLET CONFIGURATION MODAL FORM-->
			<!-- BEGIN STYLE CUSTOMIZER -->
			<!-- END BEGIN STYLE CUSTOMIZER -->
			<!-- BEGIN PAGE HEADER-->
			<!-- END PAGE HEADER-->
			<!-- BEGIN PAGE CONTENT-->
			<div class="row">
				<div class="col-md-12">
					<!-- BEGIN EXAMPLE TABLE PORTLET-->
                    <div class="device_data" style="width: 100%;background-image: url('https://first-1257059002.cos.ap-nanjing.myqcloud.com/images/bg2.jpg');height:400px ">
                        <div class="device_info" style="height: 100%;width: 500px;box-shadow: 10px 10px 5px rgba(0,0,0,0);float: left">
                            <div class="inline_box" style="width: 50%;height: 30%;float: left;margin-top: 10px">
                                <h2 style="color: white;display: inline-block;padding-left: 40px;padding-top: 40px;">设备总数</h2>
                                <p style="color: white;display: inline-block;padding-left: 72px;font-size: 40px;padding-top: 20px;">{{ device_num }}</p>
                            </div>
                            <div class="inline_box" style="width: 50%;height: 30%;float: left;margin-top: 10px">
                                <h2 style="color: white;display: inline-block;padding-left: 40px;padding-top: 40px;">在线设备</h2>
                                <p style="color: white;display: block;padding-left: 72px;font-size: 40px;padding-top: 5px;color: white">{{ online }}</p>
                            </div>
                            <div class="inline_box" style="width: 50%;height: 30%;float: left;margin-top: 30px">
                                <h2 style="color: white;display: inline-block;padding-left: 40px;padding-top: 40px;">离线设备</h2>
                                <p style="color: white;display: block;padding-left: 72px;font-size: 40px;padding-top: 5px;color: white">{{ offline }}</p>
                            </div>
                            <div class="inline_box" style="width: 50%;height: 30%;float: left;margin-top: 30px">
                                <h2 style="color: white;display: inline-block;padding-left: 40px;padding-top: 40px;">异常设备</h2>
                                <p style="color: white;display: block;padding-left: 72px;font-size: 40px;padding-top: 5px;color: white">{{ err }}</p>
                            </div>
                        </div>
                        <div id="main" class="echarts_data" style="height: 80%;width: 500px;box-shadow: 10px 10px 5px rgba(0,0,0,0);float: left;margin-top: 80px;margin-left: 100px"></div>
                        <script type="text/javascript">
                            var myChart=echarts.init(document.getElementById('main'));
                            var option={
                                title:{text:'设备列表',
                                textStyle:{
                                    fontWeight:'normal',
                                    color:'white'
                                }},
                                series:[
                                    {
                                         type:'pie',
                                         radius:'55%',
                                         name:'设备列表',
                                         data:[
                                             {value:{{ online }}, name:'在线设备'},
                                             {value:{{ offline }}, name:'离线设备'},
                                             {value:{{ err }}, name:'异常设备'},
                                         ]
                                    }
                                ]
                            };
                            myChart.setOption(option);
                        </script>
                    </div>
					<div class="portlet box blue" style="margin-top: 0px;">
						<div class="portlet-body">
							<div class="table-toolbar">
								<div class="btn-group">
									<button id="triggerBtn" style="background-color: #0275d8;font-size: 20px">添加设备</button>
                                    <div id="myModal" class="modal1">
                                        <div class="modal1-content">
                                            <div class="modal1-header">
                                                <h2></h2>
                                                <span id="closeBtn" class="close1" >×</span>
                                            </div>
                                            <div class="modal1-body">
                                                <div id="add_device">
                                                    <div id="triangle"></div>
                                                <h1>添加设备</h1>
                                                <form method="POST" action="{% url 'device:add' %}" class="add_device">
                                                    <input type="text" name="device_name" placeholder="设备名"/>
                                                    <input type="text" name="imsi" placeholder="imsi号" />
                                                    <input type="submit" value="添加" />
                                                    {% csrf_token %}
                                                </form>
                                                </div>
                                            </div>
                                            <div class="modal1-footer">
                                                <h3></h3>
                                            </div>
                                        </div>
                                    </div>
                                    <script type="text/javascript" src="https://first-1257059002.cos.ap-nanjing.myqcloud.com/js/modalBox.js"></script>
								</div>
							</div>
							<table class="table table-striped table-hover table-bordered" id="sample_editable_1">
								<thead>
									<tr>
										<th style="font-size: 20px">状态</th>
										<th style="font-size: 20px">设备名称</th>
										<th style="font-size: 20px">设备id</th>
                                        <th style="font-size: 20px">操作</th>
									</tr>
								</thead>
								<tbody>
									{% for device in devices %}
                                        <tr >
                                            <td style="font-size: 20px">{{ device.get_status_display }}</td>
                                            <td style="font-size: 20px"><a href="{% url 'device:detail' device.device_id %}" style="text-decoration: none">{{ device.device_name }}</a></td>
                                            <td style="font-size: 20px"><a href="{% url 'device:detail' device.device_id %}" style="text-decoration: none">{{ device.device_id }}</a></td>
                                            <td style="font-size: 20px" class="center"><a href="#" onclick="confirm_delete()" style="text-decoration: none">删除</a>
                                            <form style="display: none;"id="safe_delete" action="{% url 'device:delete' device.device_id %}" method="POST">
                                                {% csrf_token %}
                                                <button type="submit"></button>
                                            </form></td>
									    </tr>
                                    {% endfor %}
								</tbody>
                                <script>
                                       function confirm_delete() {
                                           layer.open({
                                               title: "确认删除",
                                               content: "确认删除这个设备",
                                               yes: function (index, layero) {
                                                   $('form#safe_delete button').click();
                                                   layer.close();
                                               }
                                           })
                                       }
                                    </script>
							</table>
						</div>
					</div>
					<!-- END EXAMPLE TABLE PORTLET-->
				</div>
			</div>
			<!-- END PAGE CONTENT -->
		</div>
    </div>
{% endblock %}
</html>
